# RSA 加密解密:

## 產生公鑰與私鑰:
假設A想要接收B的私人訊息，可以用RSA方法產生公鑰與私鑰

*    1.選擇兩個質數$p$和$q$，且$p$不等於$q$，計算$N=pq$。
*    2.求得$r=(p-1)(q-1)$
*    3.選擇一個整數$e$，使$gcd(e,r)=1$，$e$與$r$互質。
*    4.求得$d$為$e$關於$r$的模反元素
        *    $d$與$e$的關係: $(e \cdot d) / r$的餘數為1，因此$d \cdot e - k \cdot r =1$，其中$k=1,2,3,...$
*    5.銷毀$p$和$q$

$(N,e)$為公鑰，$(N,d)$為私鑰。A將公鑰$(N,e)$傳給B，並將私鑰$(N,d)$藏起來。

## 加密方式:
假如今天B想要傳送訊息$m$給A，他知道之前A給他的公鑰為$(N,e)$。B可以使用先前與A約定好的格式將$m$轉為$n$，而$0<n<N$。比如說轉換為2進制或是ASCII甚至是Unicode碼等等，而後將這些數字連在一起組成一個數字$n$，倘若訊息很長的話，可以將訊息分段，將每一段分別轉換為$n$，使用下面的公式將$n$加密為$c$:

$\qquad \qquad \qquad \qquad \qquad \qquad \qquad  c \equiv n^e (mod\ N)$

而後將$c$傳給A

## 解密方式:
A拿到經過B加密的訊息$c$之後，可以用他的私鑰$d$將其解密得到$n$，解密的公式如下:

$\qquad \qquad \qquad \qquad \qquad \qquad \qquad  n \equiv c^d (mod\ N)$

而後再使用先前與B約定好的格式將$n$還原為原本的訊息$m$即可收到B的原始訊息為何。

## 例子說明1:

### 產生公鑰與私鑰:

*    **1.選擇兩個質數$p$和$q$，且$p$不等於$q$，計算$N=pq$。**

            選擇p=61, q=53, N = pq = 3223
    
*    **2.求得$r=(p-1)(q-1)$**

            求得r = (p-1)(q-1) = 60 ‧ 52 = 3120

*    **3.選擇一個整數$e$，使$gcd(e,r)=1$，$e$與$r$互質。**

            我選e = 17，滿足gcd(17, 60 ‧ 52) = 1

*    **4.求得$d$為$e$關於$r$的模反元素**
            
            d ‧ e - k ‧ r = 1
            d ‧ 17 - k ‧ 3120 = 1
            可求出當k = 15時，d為2753滿足上式
            
*    **5.銷毀$p$和$q$**
            
            好，我銷毀了
            
因此得到$(N,e)=(3223,17)$為公鑰，$(N,d)=(3223,2753)$為私鑰。


## 例子說明2:

### 產生公鑰與私鑰:

*    **1.選擇兩個質數$p$和$q$，且$p$不等於$q$，計算$N=pq$。**

            選擇p=43, q=59, N = pq = 2537
    
*    **2.求得$r=(p-1)(q-1)$**

            求得r = (p-1)(q-1) = 42 ‧ 58 = 2436

*    **3.選擇一個整數$e$，使$gcd(e,r)=1$，$e$與$r$互質。**

            我選e = 13，滿足gcd(13, 42 ‧ 58) = 1

*    **4.求得$d$為$e$關於$r$的模反元素**
            
            d ‧ e - k ‧ r = 1
            d ‧ 13 - k ‧ 2436 = 1
            可求出當k = 5時，d為937滿足上式
            
*    **5.銷毀$p$和$q$**
            
            好，我銷毀了
            
因此得到$(N,e)=(2537,13)$為公鑰，$(N,d)=(2537,937)$為私鑰。


### 加密:

假如要加密$m=STOP$的訊息，令 $A=01, B=02, ..., Z=25$，可以得到加密後的 $n=18191415$，將其分成兩堆。並且透過 $c \equiv n^e (mod\ N)$加密訊息。

*    $n=1819$:
        $c=1819^{13} (mod\ 2537)=2081$


*    $n=1415$:
        $c=1415^{13} (mod\ 2537)=2182$

因此加密後的訊息為$20812182$

### 解密:
得到加密後的訊息後(20812182)，將其同樣分為兩堆，並且透過 $n \equiv c^d (mod\ N)$解密即可:
*    $c=2081$:
        $n=2081^{937} (mod\ 2537)=1819$
        
*    $c=2182$:
        $n=2182^{937} (mod\ 2537)=1415$
        
再根據$A=01, B=02, ..., Z=25$即可解出原始訊息為$STOP$了!

## 附錄:
若要計算$a^b(mod\ c)$這種大數的計算時，可以再使用快速冪取mod的結果，code如下:

```c=
int fpw(int a,int b,int c){
    int ans=1;
    a=a%c;
    while(b!=0){
        if(b&1) ans=(ans*a)%c;
        b>>=1;
        a=(a*a)%c;
    }
    return ans;
}
```